# **–û—Ç—á–µ—Ç –ø–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç–µ ‚Ññ3.1**

**–¢–µ–º–∞:** Django ORM. –ó–∞–ø—Ä–æ—Å—ã –∏ –∏—Ö –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

## **üéØ –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã**: –ø–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ —Ä–∞–±–æ—Ç–µ —Å –∑–∞–ø—Ä–æ—Å–∞–º–∏ –≤ Django ORM.

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ –∑–∞–¥–∞–Ω–∏—è —Å –ø–æ–º–µ—Ç–∫–æ–π –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ
–∑–∞–¥–∞–Ω–∏–µ [–∏–∑ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç—ã ‚Ññ3.1] (https://docs.google.com/document/d/1jB8EYOWk-bbjB6sLr1s7dOmLYRC9Z5jIV6xIpnigdvY/edit?usp=sharing).

---

## **üìã –£—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**

–†–∞–±–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞, —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –≤ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç–µ ‚Ññ2, –ø–æ –ø—É—Ç–∏:  
`students\k3341\Savchenko_Anastasia\practical_works\practical_work_2\simple_django_web_project\django_project_Savchenko`

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–¥–∞–Ω–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –¥–≤–∞ –ø–æ–¥—Ö–æ–¥–∞:

- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º (—á–µ—Ä–µ–∑ manage.py shell) - –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –§–∞–π–ª–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥ (—á–µ—Ä–µ–∑ —Å–æ–∑–¥–∞–Ω–∏–µ Python-—Å–∫—Ä–∏–ø—Ç–æ–≤) - –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–∞ –∑–∞—â–∏—Ç–µ –∏ —É–¥–æ–±—Å—Ç–≤–∞ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

---

## **üõ† 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –º–æ–¥–µ–ª–µ–π –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–≤—è–∑–µ–π**

### **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–≤—è–∑–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `related_name`**

–í —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∑–∞–¥–∞–Ω–∏–µ–º 2 (–ø—É–Ω–∫—Ç 1), –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã related_name –∫ –ø–æ–ª—è–º –º–æ–¥–µ–ª–µ–π –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –æ–±—Ä–∞—Ç–Ω—ã—Ö —Å–≤—è–∑–µ–π::

``` python
# –î–æ–±–∞–≤–ª–µ–Ω related_name='licenses'
class DriversLicense(models.Model):
    id_owner = models.ForeignKey(CarOwner, on_delete=models.CASCADE, related_name='licenses')
    ...

# related_name='ownerships'
class Ownership(models.Model):
    id_owner = models.ForeignKey(CarOwner, on_delete=models.CASCADE, related_name='ownerships')
    id_car = models.ForeignKey(Car, on_delete=models.CASCADE, related_name='ownerships')
    ...

# –î–ª—è —Å–≤—è–∑–∏ ManyToMany –¥–æ–±–∞–≤–ª–µ–Ω related_name
class Car(models.Model):
    owners = models.ManyToManyField(
        CarOwner,
        through='Ownership',
        through_fields=('id_car', 'id_owner'),
        related_name='owned_cars'
    )
```

### **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π**

```bash
python manage.py makemigrations
python manage.py migrate
```

### **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö**

–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ —Ñ–∞–π–ª `create_data.py` (–¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç—ã 2 –±—ã–ª–∏
–æ—á–∏—â–µ–Ω—ã(—É–¥–∞–ª–µ–Ω—ã)):

**–°–æ–∑–¥–∞–Ω–æ:**

- 7 –∞–≤—Ç–æ–≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ —Å —Ä–∞–∑–Ω—ã–º–∏ –∏–º–µ–Ω–∞–º–∏ –∏ –¥–∞—Ç–∞–º–∏ —Ä–æ–∂–¥–µ–Ω–∏—è (–ê—Ä—Ç–µ–º –í–æ–ª–∫–æ–≤, –°–æ—Ñ–∏—è –ë–µ–ª–æ–≤–∞, –ú–∞–∫—Å–∏–º –ì—Ä–æ–º–æ–≤, –ê–ª–∏—Å–∞ –ó–∞–π—Ü–µ–≤–∞, –ö–∏—Ä–∏–ª–ª
  –û—Ä–ª–æ–≤, –í–∏–∫—Ç–æ—Ä–∏—è –õ–µ–±–µ–¥–µ–≤–∞, –î–∞–Ω–∏–∏–ª –°–æ–∫–æ–ª–æ–≤)
- 6 –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–∞—Ä–æ–∫ –∏ —Ü–≤–µ—Ç–æ–≤ (Toyota Camry, Toyota RAV4, BMW X5, Mercedes E-Class, Audi A6, Hyundai Tucson)
- 7 –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–π —Å –¥–∞—Ç–∞–º–∏ –≤—ã–¥–∞—á–∏ –æ—Ç 2010 –¥–æ 2021 –≥–æ–¥–∞
- 15 –∑–∞–ø–∏—Å–µ–π –æ –≤–ª–∞–¥–µ–Ω–∏–∏ (–∫–∞–∂–¥–æ–º—É –≤–ª–∞–¥–µ–ª—å—Ü—É –Ω–∞–∑–Ω–∞—á–µ–Ω–æ –æ—Ç 1 –¥–æ 3 –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π)

---

## **üìù 2. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞–Ω–∏–π**

### **–ó–ê–î–ê–ß–ê 2: –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é (5 –∑–∞–¥–∞–Ω–∏–π)**

#### **1. –í—Å–µ –º–∞—à–∏–Ω—ã –º–∞—Ä–∫–∏ "Toyota"**

``` python
Car.objects.filter(brand='Toyota')
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

- Toyota Camry (–ß–µ—Ä–Ω—ã–π) - –°555–¢–¢77
- Toyota RAV4 (–ö—Ä–∞—Å–Ω—ã–π) - –ú123–ê–í98

**–ê–Ω–∞–ª–∏–∑:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –º–µ—Ç–æ–¥ `filter()` –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –º–æ–¥–µ–ª–∏ `Car`, —É –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–ª–µ `brand` —Ä–∞–≤–Ω–æ "Toyota".
–†–µ–∑—É–ª—å—Ç–∞—Ç - QuerySet —Å –¥–≤—É–º—è –∞–≤—Ç–æ–º–æ–±–∏–ª—è–º–∏.

#### **2. –í—Å–µ –≤–æ–¥–∏—Ç–µ–ª–∏ —Å –∏–º–µ–Ω–µ–º "–ú–∞–∫—Å–∏–º"**

``` python
CarOwner.objects.filter(first_name='–ú–∞–∫—Å–∏–º')
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–∞–∫—Å–∏–º –ì—Ä–æ–º–æ–≤

**–ê–Ω–∞–ª–∏–∑:** –ú–µ—Ç–æ–¥ `filter()` –ø—Ä–∏–º–µ–Ω–µ–Ω –∫ –º–æ–¥–µ–ª–∏ `CarOwner` —Å —É—Å–ª–æ–≤–∏–µ–º –ø–æ –ø–æ–ª—é `first_name`. –í–æ–∑–≤—Ä–∞—â–µ–Ω QuerySet —Å –æ–¥–Ω–∏–º
–æ–±—ä–µ–∫—Ç–æ–º.

#### **3. –ü–æ–ª—É—á–µ–Ω–∏–µ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è –ø–æ id –≤–ª–∞–¥–µ–ª—å—Ü–∞**

``` python
# –ü–æ–ª—É—á–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–≥–æ –≤–ª–∞–¥–µ–ª—å—Ü–∞
random_owner = random.choice(list(CarOwner.objects.all()))
owner_id = random_owner.id_owner

# –ü–æ–ª—É—á–∞–µ–º —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ –ø–æ id –≤–ª–∞–¥–µ–ª—å—Ü–∞
license = DriversLicense.objects.get(id_owner=owner_id)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

```
–°–ª—É—á–∞–π–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü: –ú–∞–∫—Å–∏–º –ì—Ä–æ–º–æ–≤
ID –≤–ª–∞–¥–µ–ª—å—Ü–∞: 12
–£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ: 77AB1002 (B)
–î–∞—Ç–∞ –≤—ã–¥–∞—á–∏: 2015-07-18
```

**–ê–Ω–∞–ª–∏–∑:** –ó–∞–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –≤ –¥–≤–∞ –∑–∞–ø—Ä–æ—Å–∞: —Å–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–µ–Ω —Å–ª—É—á–∞–π–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü, –∑–∞—Ç–µ–º —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `get()` –Ω–∞–π–¥–µ–Ω–æ
–µ–≥–æ –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–µ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ. –ú–µ—Ç–æ–¥ `get()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç –∏–ª–∏ –≤—ã–∑—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ
–∏–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.

#### **4. –í—Å–µ –≤–ª–∞–¥–µ–ª—å—Ü—ã –∫—Ä–∞—Å–Ω—ã—Ö –º–∞—à–∏–Ω**

``` python
red_cars = Car.objects.filter(color='–ö—Ä–∞—Å–Ω—ã–π')
for car in red_cars:
    owners = car.owners.all()
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ê—Ä—Ç–µ–º –í–æ–ª–∫–æ–≤

**–ê–Ω–∞–ª–∏–∑:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —Ü–µ–ø–æ—á–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤: —Å–Ω–∞—á–∞–ª–∞ –Ω–∞–π–¥–µ–Ω—ã –≤—Å–µ –∫—Ä–∞—Å–Ω—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏, –∑–∞—Ç–µ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ–º–æ–±–∏–ª—è –ø–æ–ª—É—á–µ–Ω—ã
–µ–≥–æ –≤–ª–∞–¥–µ–ª—å—Ü—ã —á–µ—Ä–µ–∑ —Å–≤—è–∑—å ManyToMany (`owners.all()`).

#### **5. –í—Å–µ –≤–ª–∞–¥–µ–ª—å—Ü—ã, —á–µ–π –≥–æ–¥ –≤–ª–∞–¥–µ–Ω–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 2021**

``` python
CarOwner.objects.filter(ownerships__start_date__year__gte=2021).distinct()
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

- –°–æ—Ñ–∏—è –ë–µ–ª–æ–≤–∞
- –ê–ª–∏—Å–∞ –ó–∞–π—Ü–µ–≤–∞
- –î–∞–Ω–∏–∏–ª –°–æ–∫–æ–ª–æ–≤

**–ê–Ω–∞–ª–∏–∑:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Å–∏–Ω—Ç–∞–∫—Å–∏—Å `__` –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –ø–æ–ª—è–º —Å–≤—è–∑–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã `Ownership`. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –≥–æ–¥—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
—Å –ø–æ–º–æ—â—å—é `__year__gte`. –ú–µ—Ç–æ–¥ `distinct()` —É—Å—Ç—Ä–∞–Ω–µ–Ω –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤–ª–∞–¥–µ—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏
–∞–≤—Ç–æ–º–æ–±–∏–ª—è–º–∏ —Å 2021 –≥–æ–¥–∞.

### **–ó–ê–î–ê–ß–ê 3: –ê–≥—Ä–µ–≥–∞—Ü–∏—è –∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è (5 –∑–∞–¥–∞–Ω–∏–π)**

#### **1. –î–∞—Ç–∞ –≤—ã–¥–∞—á–∏ —Å–∞–º–æ–≥–æ —Å—Ç–∞—Ä—à–µ–≥–æ –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è**

``` python
DriversLicense.objects.aggregate(oldest_date=Min('issue_date'))
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

```
–°–∞–º–æ–µ —Å—Ç–∞—Ä–æ–µ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ –≤—ã–¥–∞–Ω–æ: 2010-06-19
–í–ª–∞–¥–µ–ª–µ—Ü: –ê—Ä—Ç–µ–º –í–æ–ª–∫–æ–≤
```

**–ê–Ω–∞–ª–∏–∑:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ `Min()` –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã –≤ –ø–æ–ª–µ `issue_date`. –†–µ–∑—É–ª—å—Ç–∞—Ç
–≤–æ–∑–≤—Ä–∞—â–µ–Ω –≤ –≤–∏–¥–µ —Å–ª–æ–≤–∞—Ä—è —Å –∫–ª—é—á–æ–º `oldest_date`.

#### **2. –°–∞–º–∞—è –ø–æ–∑–¥–Ω—è—è –¥–∞—Ç–∞ –≤–ª–∞–¥–µ–Ω–∏—è –º–∞—à–∏–Ω–æ–π**

``` python
Ownership.objects.aggregate(latest_date=Max('start_date'))
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

```
–°–∞–º–∞—è –ø–æ–∑–¥–Ω—è—è –¥–∞—Ç–∞ –≤–ª–∞–¥–µ–Ω–∏—è: 2021-11-12
–í–ª–∞–¥–µ–ª–µ—Ü: –î–∞–Ω–∏–∏–ª
–ú–∞—à–∏–Ω–∞: Hyundai Tucson
```

**–ê–Ω–∞–ª–∏–∑:** –§—É–Ω–∫—Ü–∏—è `Max()` –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –¥–∞—Ç—ã –≤ –ø–æ–ª–µ `start_date`. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –Ω–∞–π–¥–µ–Ω –æ–±—ä–µ–∫—Ç
–≤–ª–∞–¥–µ–Ω–∏—è —Å —ç—Ç–æ–π –¥–∞—Ç–æ–π –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –≤–ª–∞–¥–µ–ª—å—Ü–µ –∏ –∞–≤—Ç–æ–º–æ–±–∏–ª–µ.

#### **3. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–æ–¥–∏—Ç–µ–ª—è**

``` python
CarOwner.objects.annotate(car_count=Count('ownerships')).order_by('-car_count')
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

- –ê—Ä—Ç–µ–º –í–æ–ª–∫–æ–≤: 3 –º–∞—à–∏–Ω
- –°–æ—Ñ–∏—è –ë–µ–ª–æ–≤–∞: 3 –º–∞—à–∏–Ω
- –î–∞–Ω–∏–∏–ª –°–æ–∫–æ–ª–æ–≤: 3 –º–∞—à–∏–Ω
- –ê–ª–∏—Å–∞ –ó–∞–π—Ü–µ–≤–∞: 2 –º–∞—à–∏–Ω
- –í–∏–∫—Ç–æ—Ä–∏—è –õ–µ–±–µ–¥–µ–≤–∞: 2 –º–∞—à–∏–Ω
- –ú–∞–∫—Å–∏–º –ì—Ä–æ–º–æ–≤: 1 –º–∞—à–∏–Ω
- –ö–∏—Ä–∏–ª–ª –û—Ä–ª–æ–≤: 1 –º–∞—à–∏–Ω

**–ê–Ω–∞–ª–∏–∑:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è `Count('ownerships')`, –∫–æ—Ç–æ—Ä–∞—è –¥–æ–±–∞–≤–ª—è–µ—Ç –∫–∞–∂–¥–æ–º—É –æ–±—ä–µ–∫—Ç—É `CarOwner` –Ω–æ–≤–æ–µ –ø–æ–ª–µ
`car_count` —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –≤ —Ç–∞–±–ª–∏—Ü–µ `Ownership`. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞
–º–∞—à–∏–Ω.

#### **4. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω –∫–∞–∂–¥–æ–π –º–∞—Ä–∫–∏**

``` python
Car.objects.values('brand').annotate(count=Count('id_car')).order_by('-count')
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

- Toyota: 2 –º–∞—à–∏–Ω
- Mercedes: 1 –º–∞—à–∏–Ω
- Hyundai: 1 –º–∞—à–∏–Ω
- BMW: 1 –º–∞—à–∏–Ω
- Audi: 1 –º–∞—à–∏–Ω

**–ê–Ω–∞–ª–∏–∑:** –ö–æ–º–±–∏–Ω–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤ `values()` –∏ `annotate()` –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É (–∞–Ω–∞–ª–æ–≥ GROUP BY –≤ SQL). –ú–µ—Ç–æ–¥
`values('brand')` –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –ø–æ –º–∞—Ä–∫–µ, –∞ `annotate(count=Count('id_car'))` –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
–∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π –≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø–µ.

#### **5. –í—Å–µ –∞–≤—Ç–æ–≤–ª–∞–¥–µ–ª—å—Ü—ã, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –¥–∞—Ç–µ –≤—ã–¥–∞—á–∏ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è**

``` python
CarOwner.objects.filter(licenses__isnull=False).order_by('licenses__issue_date').distinct()
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

- –ê—Ä—Ç–µ–º –í–æ–ª–∫–æ–≤: 2010-06-19
- –°–æ—Ñ–∏—è –ë–µ–ª–æ–≤–∞: 2012-05-11
- –ú–∞–∫—Å–∏–º –ì—Ä–æ–º–æ–≤: 2015-07-18
- –ê–ª–∏—Å–∞ –ó–∞–π—Ü–µ–≤–∞: 2017-06-13
- –ö–∏—Ä–∏–ª–ª –û—Ä–ª–æ–≤: 2018-01-25
- –í–∏–∫—Ç–æ—Ä–∏—è –õ–µ–±–µ–¥–µ–≤–∞: 2020-12-01
- –î–∞–Ω–∏–∏–ª –°–æ–∫–æ–ª–æ–≤: 2021-11-16

**–ê–Ω–∞–ª–∏–∑:** –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ –ø–æ–ª—é —Å–≤—è–∑–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã `licenses__issue_date`. –ú–µ—Ç–æ–¥ `distinct()` –∏—Å–∫–ª—é—á–∏–ª –≤–æ–∑–º–æ–∂–Ω—ã–µ
–¥—É–±–ª–∏–∫–∞—Ç—ã, –µ—Å–ª–∏ –±—ã —É –≤–ª–∞–¥–µ–ª—å—Ü–∞ –±—ã–ª–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–π. –ú–µ—Ç–æ–¥ `filter(licenses__isnull=False)` –∏—Å–∫–ª—é—á–∏–ª –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤
–±–µ–∑ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–π.

---

## **üîç –ê–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤**

### **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã Django ORM:**

1. **`filter()`** - –¥–ª—è –≤—ã–±–æ—Ä–∫–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –ø–æ —É—Å–ª–æ–≤–∏—è–º
2. **`get()`** - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –ø–æ —É—Å–ª–æ–≤–∏—é
3. **`all()`** - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤
4. **`aggregate()`** - –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö (Min, Max, Count, Avg)
5. **`annotate()`** - –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª–µ–π –∫ –∫–∞–∂–¥–æ–º—É –æ–±—ä–µ–∫—Ç—É
6. **`values()`** - –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
7. **`order_by()`** - –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
8. **`distinct()`** - –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –¥—É–±–ª–∏–∫–∞—Ç–æ–≤

### **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞:**

- **–î–≤–æ–π–Ω–æ–µ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞–Ω–∏–µ `__`** - –¥–ª—è –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –ø–æ–ª—è–º —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ownerships__start_date__year`)
- **–ú–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–ª–µ–π** - `__gte` (–±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ), `__year` (–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –≥–æ–¥–∞ –∏–∑ –¥–∞—Ç—ã)
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `related_name`** - –¥–ª—è —É–¥–æ–±–Ω—ã—Ö –æ–±—Ä–∞—Ç–Ω—ã—Ö —Å–≤—è–∑–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, `owner.licenses` –≤–º–µ—Å—Ç–æ
  `DriversLicense.objects.filter(id_owner=owner)`)

---

## **–í—ã–≤–æ–¥—ã –∏ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ**

–í —Ö–æ–¥–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–±–æ—Ç—ã –±—ã–ª–∏ —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤—Å–µ 10 –∑–∞–¥–∞–Ω–∏–π, —á—Ç–æ –ø–æ–º–æ–≥–ª–æ –æ–≤–ª–∞–¥–µ—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏
Django ORM. –ü—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å QuerySet –∏ –º–µ—Ç–æ–¥–∞–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `related_name` –¥–ª—è
—É–¥–æ–±–Ω—ã—Ö –æ–±—Ä–∞—Ç–Ω—ã—Ö —Å–≤—è–∑–µ–π, –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã, –∞ —Ç–∞–∫–∂–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å –∞–≥—Ä–µ–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
`(Min, Max, Count)` –∏ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é `values()` –∏ `annotate()`, —á—Ç–æ –≤–∫–ª—é—á–∞–ª–æ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏
—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö.

–†–∞–±–æ—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∞, —á—Ç–æ Django ORM –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–æ—â–Ω—ã–π –∏ –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ä–∏–π –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö,
–ø–æ–∑–≤–æ–ª—è—é—â–∏–π –≤—ã–ø–æ–ª–Ω—è—Ç—å —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ –Ω–∞–ø–∏—Å–∞–Ω–∏—è SQL-–∫–æ–¥–∞, –ø—Ä–∏ —ç—Ç–æ–º —Å–æ—Ö—Ä–∞–Ω—è—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å
–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∫–æ–¥

–í–æ—Ç –∫–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ–æ—Ä–º–∞—Ç–∞ content tabs:

=== "–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è"

    ```
    PS C:\Users\Anastasia\WebDev_ITMO\TonikX-ITMO_ICT_WebDevelopment_2025-2026\students\k3341\Savchenko_Anastasia\practical_works\practical_work_2\simple_django_web_project\django_project_Savchenko> python execute_tasks.py
    ======================================================================
    –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ê–Ø –†–ê–ë–û–¢–ê 3.1 - –í–´–ü–û–õ–ù–ï–ù–ò–ï –ó–ê–ü–†–û–°–û–í
    ======================================================================

    üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –î–ê–ù–ù–´–•:
    ‚Ä¢ –í–ª–∞–¥–µ–ª—å—Ü–µ–≤: 7
    ‚Ä¢ –ê–≤—Ç–æ–º–æ–±–∏–ª–µ–π: 6
    ‚Ä¢ –£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–π: 7
    ‚Ä¢ –í–ª–∞–¥–µ–Ω–∏–π: 15

    ======================================================================
    –ó–ê–î–ê–ß–ê 2: –ü–†–û–°–¢–´–ï –ó–ê–ü–†–û–°–´ –ù–ê –§–ò–õ–¨–¢–†–ê–¶–ò–Æ
    ======================================================================

    1. üîß –í—Å–µ –º–∞—à–∏–Ω—ã –º–∞—Ä–∫–∏ 'Toyota':
       ‚Ä¢ Toyota Camry (–ß–µ—Ä–Ω—ã–π) - –°555–¢–¢77
       ‚Ä¢ Toyota RAV4 (–ö—Ä–∞—Å–Ω—ã–π) - –ú123–ê–í98

    2. üë§ –í—Å–µ –≤–æ–¥–∏—Ç–µ–ª–∏ —Å –∏–º–µ–Ω–µ–º '–ú–∞–∫—Å–∏–º':
       ‚Ä¢ –ú–∞–∫—Å–∏–º –ì—Ä–æ–º–æ–≤

    3. ü™™ –ü–æ–ª—É—á–µ–Ω–∏–µ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è –ø–æ id –≤–ª–∞–¥–µ–ª—å—Ü–∞:
       –°–ª—É—á–∞–π–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü: –ú–∞–∫—Å–∏–º –ì—Ä–æ–º–æ–≤
       ID –≤–ª–∞–¥–µ–ª—å—Ü–∞: 12
       –£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ: 77AB1002 (B)
       –î–∞—Ç–∞ –≤—ã–¥–∞—á–∏: 2015-07-18

    4. üî¥ –í—Å–µ –≤–ª–∞–¥–µ–ª—å—Ü—ã –∫—Ä–∞—Å–Ω—ã—Ö –º–∞—à–∏–Ω:
       ‚Ä¢ –ê—Ä—Ç–µ–º –í–æ–ª–∫–æ–≤

    5. üìÖ –í—Å–µ –≤–ª–∞–¥–µ–ª—å—Ü—ã, —á–µ–π –≥–æ–¥ –≤–ª–∞–¥–µ–Ω–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 2021:
       ‚Ä¢ –°–æ—Ñ–∏—è –ë–µ–ª–æ–≤–∞
       ‚Ä¢ –ê–ª–∏—Å–∞ –ó–∞–π—Ü–µ–≤–∞
       ‚Ä¢ –î–∞–Ω–∏–∏–ª –°–æ–∫–æ–ª–æ–≤

    ======================================================================
    –ó–ê–î–ê–ß–ê 3: –ê–ì–†–ï–ì–ê–¶–ò–Ø –ò –ê–ù–ù–û–¢–ê–¶–ò–Ø
    ======================================================================

    1. üï∞Ô∏è –î–∞—Ç–∞ –≤—ã–¥–∞—á–∏ —Å–∞–º–æ–≥–æ —Å—Ç–∞—Ä—à–µ–≥–æ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è:
       –°–∞–º–æ–µ —Å—Ç–∞—Ä–æ–µ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ –≤—ã–¥–∞–Ω–æ: 2010-06-19
       –í–ª–∞–¥–µ–ª–µ—Ü: –ê—Ä—Ç–µ–º –í–æ–ª–∫–æ–≤

    2. üìÜ –°–∞–º–∞—è –ø–æ–∑–¥–Ω—è—è –¥–∞—Ç–∞ –≤–ª–∞–¥–µ–Ω–∏—è –º–∞—à–∏–Ω–æ–π:
       –°–∞–º–∞—è –ø–æ–∑–¥–Ω—è—è –¥–∞—Ç–∞ –≤–ª–∞–¥–µ–Ω–∏—è: 2021-11-12
       –í–ª–∞–¥–µ–ª–µ—Ü: –î–∞–Ω–∏–∏–ª
       –ú–∞—à–∏–Ω–∞: Hyundai Tucson

    3. üöó –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–æ–¥–∏—Ç–µ–ª—è:
       –ê—Ä—Ç–µ–º –í–æ–ª–∫–æ–≤: 3 –º–∞—à–∏–Ω
       –°–æ—Ñ–∏—è –ë–µ–ª–æ–≤–∞: 3 –º–∞—à–∏–Ω
       –î–∞–Ω–∏–∏–ª –°–æ–∫–æ–ª–æ–≤: 3 –º–∞—à–∏–Ω
       –ê–ª–∏—Å–∞ –ó–∞–π—Ü–µ–≤–∞: 2 –º–∞—à–∏–Ω
       –í–∏–∫—Ç–æ—Ä–∏—è –õ–µ–±–µ–¥–µ–≤–∞: 2 –º–∞—à–∏–Ω
       –ú–∞–∫—Å–∏–º –ì—Ä–æ–º–æ–≤: 1 –º–∞—à–∏–Ω
       –ö–∏—Ä–∏–ª–ª –û—Ä–ª–æ–≤: 1 –º–∞—à–∏–Ω

    4. üè≠ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω –∫–∞–∂–¥–æ–π –º–∞—Ä–∫–∏:
       Toyota: 2 –º–∞—à–∏–Ω
       Mercedes: 1 –º–∞—à–∏–Ω
       Hyundai: 1 –º–∞—à–∏–Ω
       BMW: 1 –º–∞—à–∏–Ω
       Audi: 1 –º–∞—à–∏–Ω

    5. üìä –ê–≤—Ç–æ–≤–ª–∞–¥–µ–ª—å—Ü—ã, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –¥–∞—Ç–µ –≤—ã–¥–∞—á–∏ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è:
       –ê—Ä—Ç–µ–º –í–æ–ª–∫–æ–≤: 2010-06-19
       –°–æ—Ñ–∏—è –ë–µ–ª–æ–≤–∞: 2012-05-11
       –ú–∞–∫—Å–∏–º –ì—Ä–æ–º–æ–≤: 2015-07-18
       –ê–ª–∏—Å–∞ –ó–∞–π—Ü–µ–≤–∞: 2017-06-13
       –ö–∏—Ä–∏–ª–ª –û—Ä–ª–æ–≤: 2018-01-25
       –í–∏–∫—Ç–æ—Ä–∏—è –õ–µ–±–µ–¥–µ–≤–∞: 2020-12-01
       –î–∞–Ω–∏–∏–ª –°–æ–∫–æ–ª–æ–≤: 2021-11-16

    ======================================================================
    ‚úÖ –í–°–ï –ó–ê–î–ê–ù–ò–Ø –í–´–ü–û–õ–ù–ï–ù–´ –£–°–ü–ï–®–ù–û!
    ======================================================================
    ```

=== "–ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π"

    ```python
    # execute_tasks.py
    import os
    import django

    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'django_project_Savchenko.settings')
    django.setup()

    from project_first_app.models import CarOwner, Car, Ownership, DriversLicense
    from django.db.models import Count, Min, Max
    import random

    print("=" * 70)
    print("–ü–†–ê–ö–¢–ò–ß–ï–°–ö–ê–Ø –†–ê–ë–û–¢–ê 3.1 - –í–´–ü–û–õ–ù–ï–ù–ò–ï –ó–ê–ü–†–û–°–û–í")
    print("=" * 70)

    print("\nüìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –î–ê–ù–ù–´–•:")
    print(f"‚Ä¢ –í–ª–∞–¥–µ–ª—å—Ü–µ–≤: {CarOwner.objects.count()}")
    print(f"‚Ä¢ –ê–≤—Ç–æ–º–æ–±–∏–ª–µ–π: {Car.objects.count()}")
    print(f"‚Ä¢ –£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–π: {DriversLicense.objects.count()}")
    print(f"‚Ä¢ –í–ª–∞–¥–µ–Ω–∏–π: {Ownership.objects.count()}")

    # ============================================================================
    # –ó–ê–î–ê–ß–ê 2: –ü–†–û–°–¢–´–ï –ó–ê–ü–†–û–°–´ –ù–ê –§–ò–õ–¨–¢–†–ê–¶–ò–Æ
    # ============================================================================
    print("\n" + "=" * 70)
    print("–ó–ê–î–ê–ß–ê 2: –ü–†–û–°–¢–´–ï –ó–ê–ü–†–û–°–´ –ù–ê –§–ò–õ–¨–¢–†–ê–¶–ò–Æ")
    print("=" * 70)

    # 1. –í—Å–µ –º–∞—à–∏–Ω—ã –º–∞—Ä–∫–∏ "Toyota"
    print("\n1. üîß –í—Å–µ –º–∞—à–∏–Ω—ã –º–∞—Ä–∫–∏ 'Toyota':")
    toyota_cars = Car.objects.filter(brand='Toyota')
    if toyota_cars.exists():
        for car in toyota_cars:
            print(f"   ‚Ä¢ {car.brand} {car.model} ({car.color}) - {car.state_number}")
    else:
        print("   –ú–∞—à–∏–Ω –º–∞—Ä–∫–∏ Toyota –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")

    # 2. –í—Å–µ –≤–æ–¥–∏—Ç–µ–ª–∏ —Å –∏–º–µ–Ω–µ–º "–ú–∞–∫—Å–∏–º"
    print("\n2. üë§ –í—Å–µ –≤–æ–¥–∏—Ç–µ–ª–∏ —Å –∏–º–µ–Ω–µ–º '–ú–∞–∫—Å–∏–º':")
    maxim_owners = CarOwner.objects.filter(first_name='–ú–∞–∫—Å–∏–º')
    if maxim_owners.exists():
        for owner in maxim_owners:
            print(f"   ‚Ä¢ {owner.first_name} {owner.last_name}")
    else:
        print("   –í–æ–¥–∏—Ç–µ–ª–µ–π —Å –∏–º–µ–Ω–µ–º –ú–∞–∫—Å–∏–º –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")

    # 3. –ü–æ–ª—É—á–µ–Ω–∏–µ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è –ø–æ id –≤–ª–∞–¥–µ–ª—å—Ü–∞
    print("\n3. ü™™ –ü–æ–ª—É—á–µ–Ω–∏–µ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è –ø–æ id –≤–ª–∞–¥–µ–ª—å—Ü–∞:")
    all_owners = list(CarOwner.objects.all())
    if all_owners:
        random_owner = random.choice(all_owners)
        owner_id = random_owner.id_owner
        print(f"   –°–ª—É—á–∞–π–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü: {random_owner.first_name} {random_owner.last_name}")
        print(f"   ID –≤–ª–∞–¥–µ–ª—å—Ü–∞: {owner_id}")

        try:
            license = DriversLicense.objects.get(id_owner=owner_id)
            print(f"   –£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ: {license.license_number} ({license.type})")
            print(f"   –î–∞—Ç–∞ –≤—ã–¥–∞—á–∏: {license.issue_date}")
        except DriversLicense.DoesNotExist:
            print(f"   –£ –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Å ID {owner_id} –Ω–µ—Ç —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è")
    else:
        print("   –ù–µ—Ç –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –≤ –±–∞–∑–µ")

    # 4. –í—Å–µ –≤–ª–∞–¥–µ–ª—å—Ü—ã –∫—Ä–∞—Å–Ω—ã—Ö –º–∞—à–∏–Ω
    print("\n4. üî¥ –í—Å–µ –≤–ª–∞–¥–µ–ª—å—Ü—ã –∫—Ä–∞—Å–Ω—ã—Ö –º–∞—à–∏–Ω:")
    red_cars = Car.objects.filter(color='–ö—Ä–∞—Å–Ω—ã–π')
    if red_cars.exists():
        owners_found = set()
        for car in red_cars:
            owners = car.owners.all()
            for owner in owners:
                owners_found.add(owner)

        for owner in owners_found:
            print(f"   ‚Ä¢ {owner.first_name} {owner.last_name}")
    else:
        print("   –ö—Ä–∞—Å–Ω—ã—Ö –º–∞—à–∏–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")

    # 5. –í—Å–µ –≤–ª–∞–¥–µ–ª—å—Ü—ã, —á–µ–π –≥–æ–¥ –≤–ª–∞–¥–µ–Ω–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 2021
    print("\n5. üìÖ –í—Å–µ –≤–ª–∞–¥–µ–ª—å—Ü—ã, —á–µ–π –≥–æ–¥ –≤–ª–∞–¥–µ–Ω–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 2021:")
    owners_2021 = CarOwner.objects.filter(
        ownerships__start_date__year__gte=2021
    ).distinct()
    if owners_2021.exists():
        for owner in owners_2021:
            print(f"   ‚Ä¢ {owner.first_name} {owner.last_name}")
    else:
        print("   –í–ª–∞–¥–µ–ª—å—Ü–µ–≤ —Å –≥–æ–¥–æ–º –≤–ª–∞–¥–µ–Ω–∏—è —Å 2021 –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")

    # ============================================================================
    # –ó–ê–î–ê–ß–ê 3: –ê–ì–†–ï–ì–ê–¶–ò–Ø –ò –ê–ù–ù–û–¢–ê–¶–ò–Ø
    # ============================================================================
    print("\n" + "=" * 70)
    print("–ó–ê–î–ê–ß–ê 3: –ê–ì–†–ï–ì–ê–¶–ò–Ø –ò –ê–ù–ù–û–¢–ê–¶–ò–Ø")
    print("=" * 70)

    # 1. –î–∞—Ç–∞ –≤—ã–¥–∞—á–∏ —Å–∞–º–æ–≥–æ —Å—Ç–∞—Ä—à–µ–≥–æ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è
    print("\n1. üï∞Ô∏è –î–∞—Ç–∞ –≤—ã–¥–∞—á–∏ —Å–∞–º–æ–≥–æ —Å—Ç–∞—Ä—à–µ–≥–æ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è:")
    oldest_license = DriversLicense.objects.aggregate(oldest_date=Min('issue_date'))
    if oldest_license['oldest_date']:
        print(f"   –°–∞–º–æ–µ —Å—Ç–∞—Ä–æ–µ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–µ –≤—ã–¥–∞–Ω–æ: {oldest_license['oldest_date']}")

        oldest_license_obj = DriversLicense.objects.filter(
            issue_date=oldest_license['oldest_date']
        ).first()
        if oldest_license_obj:
            print(f"   –í–ª–∞–¥–µ–ª–µ—Ü: {oldest_license_obj.id_owner.first_name} {oldest_license_obj.id_owner.last_name}")
    else:
        print("   –£–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")

    # 2. –°–∞–º–∞—è –ø–æ–∑–¥–Ω—è—è –¥–∞—Ç–∞ –≤–ª–∞–¥–µ–Ω–∏—è –º–∞—à–∏–Ω–æ–π
    print("\n2. üìÜ –°–∞–º–∞—è –ø–æ–∑–¥–Ω—è—è –¥–∞—Ç–∞ –≤–ª–∞–¥–µ–Ω–∏—è –º–∞—à–∏–Ω–æ–π:")
    latest_ownership = Ownership.objects.aggregate(latest_date=Max('start_date'))
    if latest_ownership['latest_date']:
        print(f"   –°–∞–º–∞—è –ø–æ–∑–¥–Ω—è—è –¥–∞—Ç–∞ –≤–ª–∞–¥–µ–Ω–∏—è: {latest_ownership['latest_date']}")

        latest_ownership_obj = Ownership.objects.filter(start_date=latest_ownership['latest_date']).first()
        if latest_ownership_obj:
            print(f"   –í–ª–∞–¥–µ–ª–µ—Ü: {latest_ownership_obj.id_owner.first_name}")
            print(f"   –ú–∞—à–∏–Ω–∞: {latest_ownership_obj.id_car.brand} {latest_ownership_obj.id_car.model}")
    else:
        print("   –í–ª–∞–¥–µ–Ω–∏–π –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")

    # 3. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–æ–¥–∏—Ç–µ–ª—è
    print("\n3. üöó –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤–æ–¥–∏—Ç–µ–ª—è:")
    owners_with_car_count = CarOwner.objects.annotate(car_count=Count('ownerships')).order_by('-car_count')
    for owner in owners_with_car_count:
        print(f"   {owner.first_name} {owner.last_name}: {owner.car_count} –º–∞—à–∏–Ω")

    # 4. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω –∫–∞–∂–¥–æ–π –º–∞—Ä–∫–∏
    print("\n4. üè≠ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω –∫–∞–∂–¥–æ–π –º–∞—Ä–∫–∏:")
    cars_by_brand = Car.objects.values('brand').annotate(count=Count('id_car')).order_by('-count')
    for item in cars_by_brand:
        print(f"   {item['brand']}: {item['count']} –º–∞—à–∏–Ω")

    # 5. –í—Å–µ –∞–≤—Ç–æ–≤–ª–∞–¥–µ–ª—å—Ü—ã, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –¥–∞—Ç–µ –≤—ã–¥–∞—á–∏ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è
    print("\n5. üìä –ê–≤—Ç–æ–≤–ª–∞–¥–µ–ª—å—Ü—ã, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –¥–∞—Ç–µ –≤—ã–¥–∞—á–∏ —É–¥–æ—Å—Ç–æ–≤–µ—Ä–µ–Ω–∏—è:")
    owners_sorted = CarOwner.objects.filter(licenses__isnull=False).order_by('licenses__issue_date').distinct()
    for owner in owners_sorted:
        license = owner.licenses.first()
        print(f"   {owner.first_name} {owner.last_name}: {license.issue_date}")

    print("\n" + "=" * 70)
    print("‚úÖ –í–°–ï –ó–ê–î–ê–ù–ò–Ø –í–´–ü–û–õ–ù–ï–ù–´ –£–°–ü–ï–®–ù–û!")
    print("=" * 70)
    ```